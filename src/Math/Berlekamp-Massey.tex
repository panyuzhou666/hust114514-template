如果要求出一个次数为 $k$ 的递推式，则输入的数列需要至少有 $2k$ 项。

返回的内容满足 $\sum_{j = 0} ^ {m - 1} a_{i - j} c_j = 0$，并且 $c_0 = 1$。

如果不加最后的处理的话，代码返回的结果会变成 $a_i = \sum_{j = 0} ^ {m - 1} c_{j - 1} a_{i - j}$，有时候这样会方便接着跑递推，需要的话就删掉最后的处理。

\inputminted{cpp}{src/Math/Berlekamp-Massey.cpp}

如果要求向量序列的递推式，就把每位乘一个随机权值(或者说是乘一个随机行向量 $v^T$)变成求数列递推式即可。如果是矩阵序列的话就随机一个行向量 $u^T$ 和列向量 $v$，然后把矩阵变成 $u^T A v$ 的数列。

\paragraph*{优化矩阵快速幂DP}

	假设 $f_i$ 有 $n$ 维，先暴力求出 $f_{0\textasciitilde 2n - 1}$，然后跑 Berlekamp-Massey，最后调用快速线性递推即可。

\paragraph*{求矩阵最小多项式}

	矩阵 $A$ 的最小多项式是次数最小的并且 $f(A) = 0$ 的多项式 $f$。实际上最小多项式就是 $\{A^i\}$ 的最小递推式，所以直接调用 Berlekamp-Massey 就好了，显然它的次数不超过$n$。

	瓶颈在于求出 $A^i$，实际上我们只要处理 $A^i v$ 就行了，每次对向量做递推。

\paragraph*{求稀疏矩阵的行列式}

	如果能求出特征多项式，则常数项乘上 $(-1)^n$ 就是行列式，但是最小多项式不一定就是特征多项式。

	把 $A$ 乘上一个随机对角阵 $B$，则 $AB$ 的最小多项式有很大概率就是特征多项式，最后再除掉 $\text{det}\;B$ 就行了。

\paragraph*{求稀疏矩阵的秩}

	设 $A$ 是一个 $n\times m$ 的矩阵, 首先随机一个 $n\times n$ 的对角阵 $P$ 和一个 $m\times m$ 的对角阵 $Q$, 然后计算 $Q A P A^T Q$ 的最小多项式即可。

	实际上不用计算这个矩阵，因为求最小多项式时要用它乘一个向量，我们依次把这几个矩阵乘到向量里就行了。答案就是最小多项式除掉所有 $x$ 因子后剩下的次数。

\paragraph*{解稀疏方程组}

	$Ax = b$，其中 $A$ 是一个$n \times n$ 的\textbf{满秩}稀疏矩阵，$b$ 和 $x$ 是 $1\times n$ 的\textbf{列}向量，$A, b$ 已知，需要解出 $x$。

	做法: 显然 $x = A^{-1} b$. 如果我们能求出 $\{A^i b\}$($i \ge 0$)的最小递推式$\{r_{0 \dots m - 1}\}$($m \le n$)，那么就有结论

	$$ A^{-1} b = -\frac 1 {r_{m - 1}} \sum_{i = 0} ^ {m - 2} A^i b r_{m - 2 - i} $$

	因为 $A$ 是稀疏矩阵，直接按定义递推出 $b \dots A^{2n - 1} b$ 即可。
	
	\inputminted{cpp}{src/Math/解稀疏方程组.cpp}
